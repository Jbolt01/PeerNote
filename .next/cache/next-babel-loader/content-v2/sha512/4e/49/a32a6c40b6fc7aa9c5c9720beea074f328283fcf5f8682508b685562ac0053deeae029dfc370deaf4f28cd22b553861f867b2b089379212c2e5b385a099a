{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/vijay/PeerNote/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/vijay/PeerNote/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/vijay/PeerNote/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/vijay/PeerNote/src/pages/community/course/[id].tsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\n\n/* eslint-disable react/no-unescaped-entities */\nimport { Text, Img, Spacer, Button, Icon, Box, Modal, ModalOverlay, ModalContent, ModalHeader, ModalFooter, ModalBody, useDisclosure, VStack, HStack, FormControl, useToast } from '@chakra-ui/react';\nimport Head from 'next/head';\nimport router from 'next/router';\nimport { useState, useEffect } from 'react';\nimport { useSession } from 'next-auth/client';\nimport { useForm } from 'react-hook-form';\nimport * as yup from 'yup';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { FiPaperclip } from 'react-icons/fi';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\nimport { Input } from '../../../components/form/input';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\nimport { MaterialList } from '../../../components/MaterialList';\nimport { useGetLatestMaterials, useGetTopLikedMaterials } from '../../../services/hooks/useMaterials';\nimport useLocale from '../../../services/hooks/useLocale';\nimport { incrementCourseView } from '../../../services/hooks/useCourses';\nvar createMaterialFormSchema = yup.object().shape({\n  name: yup.string().max(120, 'Maximum 120 characters').required('Wait, you would not forget the name would you?'),\n  description: yup.string().max(200, 'Maximum 200 characters').required(\"Don't forget the description\"),\n  image: yup.string().url(),\n  link: yup.string().url().required('Material link required'),\n  tags: yup.string().lowercase().min(3, 'Come on, at least 3 characters you can do it').max(144, 'Maximum 144 characters').required('Tags are important to help others to find the course :)')\n});\nexport var __N_SSP = true;\nexport default function CoursePage(_ref) {\n  _s();\n\n  var singleCourseData = _ref.singleCourseData,\n      currentUser = _ref.currentUser,\n      courseLiked = _ref.courseLiked;\n\n  var _useDisclosure = useDisclosure(),\n      isOpen = _useDisclosure.isOpen,\n      onOpen = _useDisclosure.onOpen,\n      onClose = _useDisclosure.onClose;\n\n  var _useState = useState(courseLiked),\n      liked = _useState[0],\n      setLiked = _useState[1];\n\n  var _useSession = useSession(),\n      _useSession2 = _slicedToArray(_useSession, 1),\n      session = _useSession2[0];\n\n  var toast = useToast();\n  var t = useLocale();\n  useEffect(function () {\n    incrementCourseView(singleCourseData.id);\n  }, []);\n  var currentUserId = currentUser === null || currentUser === void 0 ? void 0 : currentUser.id;\n  var courseId = singleCourseData === null || singleCourseData === void 0 ? void 0 : singleCourseData.id;\n\n  var _useGetLatestMaterial = useGetLatestMaterials(courseId),\n      latestsMaterialsData = _useGetLatestMaterial.data,\n      isLoadingLatestMaterials = _useGetLatestMaterial.isLoading,\n      isFetchingLatestMaterials = _useGetLatestMaterial.isFetching,\n      errorLatestMaterials = _useGetLatestMaterial.error;\n\n  var _useGetTopLikedMateri = useGetTopLikedMaterials(courseId),\n      topMaterialsData = _useGetTopLikedMateri.data,\n      isLoadingTopMaterials = _useGetTopLikedMateri.isLoading,\n      isFetchingTopMaterials = _useGetTopLikedMateri.isFetching,\n      errorTopMaterials = _useGetTopLikedMateri.error;\n\n  var _useForm = useForm({\n    resolver: yupResolver(createMaterialFormSchema)\n  }),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      formState = _useForm.formState,\n      errors = _useForm.errors;\n\n  var handleCreateMaterial = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api.post('/api/supaRequests', {\n                headers: {\n                  type: 'course-create-material'\n                },\n                values: values,\n                currentUserId: currentUserId,\n                courseId: courseId\n              });\n\n            case 2:\n              response = _context.sent;\n              _context.next = 5;\n              return new Promise(function (resolve) {\n                return setTimeout(resolve, 1000);\n              });\n\n            case 5:\n              onClose();\n              toast({\n                title: \"\".concat(t.coursePage.toast.title),\n                description: \"\".concat(t.coursePage.toast.description),\n                status: 'success',\n                duration: 2000,\n                isClosable: true,\n                position: 'top-right',\n                onCloseComplete: function onCloseComplete() {\n                  return router.push(\"/community/summary/\".concat(response.data.newMaterialId));\n                }\n              });\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleCreateMaterial(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleLikeCourse = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var response, _response;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!session) {\n                _context2.next = 12;\n                break;\n              }\n\n              if (!(liked === false)) {\n                _context2.next = 8;\n                break;\n              }\n\n              setLiked(!liked);\n              _context2.next = 5;\n              return api.post('/api/supaRequests', {\n                headers: {\n                  type: 'course-like-course'\n                },\n                currentUserId: currentUserId,\n                courseId: courseId\n              });\n\n            case 5:\n              response = _context2.sent;\n              _context2.next = 12;\n              break;\n\n            case 8:\n              setLiked(!liked);\n              _context2.next = 11;\n              return api.post('/api/supaRequests', {\n                headers: {\n                  type: 'course-unlike-course'\n                },\n                currentUserId: currentUserId,\n                courseId: courseId\n              });\n\n            case 11:\n              _response = _context2.sent;\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleLikeCourse() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  if (singleCourseData === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Head, {\n        children: /*#__PURE__*/_jsxDEV(\"title\", {\n          children: t.page404.tabMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  var course = singleCourseData;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: course.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      w: \"90%\",\n      mx: \"auto\",\n      display: {\n        md: 'flex'\n      },\n      maxWidth: 1080,\n      marginTop: 12,\n      marginBottom: 4,\n      border: \"1px\",\n      borderColor: \"green.700\",\n      borderRadius: \"2xl\",\n      justifyContent: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        position: \"relative\",\n        maxHeight: {\n          sm: '240px',\n          md: 'xl',\n          lg: 'xl'\n        },\n        h: {\n          lg: 'xl',\n          md: 'xl',\n          sm: '240px'\n        },\n        w: {\n          sm: '100%',\n          md: '50%',\n          lg: '50%'\n        },\n        borderRadius: \"2xl\",\n        children: /*#__PURE__*/_jsxDEV(Img, {\n          maxHeight: {\n            lg: 'xl',\n            md: 'xl',\n            sm: '240px'\n          },\n          h: {\n            lg: 'xl',\n            md: 'xl',\n            sm: '240px'\n          },\n          w: \"50%\",\n          boxSize: \"100%\",\n          objectFit: \"cover\",\n          src: course.image !== '' ? course.image : '/assets/illustrations/courseImg.jpg',\n          fallbac: \"/assets/illustrations/courseImg.jpg\",\n          alt: \"Course Image\",\n          borderRadius: \"2xl\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(VStack, {\n        h: {\n          md: 'xl',\n          sm: 'md'\n        },\n        w: {\n          sm: '100%',\n          md: '50%',\n          lg: '50%'\n        },\n        bg: \"purple.900\",\n        minWidth: {\n          md: '50%',\n          lg: '50%'\n        },\n        alignItems: \"left\",\n        borderBottomRadius: \"2xl\",\n        borderTopRightRadius: \"2xl\",\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          mb: ['1', '2', '4'],\n          fontWeight: \"700\",\n          fontSize: ['xl', '2xl', '3xl'],\n          lineHeight: \"9\",\n          px: ['6', '8'],\n          pt: ['2', '3', '6'],\n          children: course.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          px: ['6', '8'],\n          lineHeight: \"5\",\n          color: \"green.600\",\n          noOfLines: 6,\n          fontSize: ['sm', 'md', 'lg'],\n          children: course.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Spacer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          align: \"right\",\n          w: \"100%\",\n          children: /*#__PURE__*/_jsxDEV(HStack, {\n            w: \"16\",\n            bgColor: \"green.900\",\n            borderBottomRightRadius: \"2xl\",\n            borderTopLeftRadius: \"2xl\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              pl: \"5\",\n              size: \"lg\",\n              color: \"green.500\",\n              variant: \"unstyled\",\n              fontSize: \"2xl\",\n              justifyContent: \"center\",\n              onClick: handleLikeCourse,\n              isDisabled: !session,\n              children: liked ? /*#__PURE__*/_jsxDEV(AiFillHeart, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 26\n              }, this) : /*#__PURE__*/_jsxDEV(AiOutlineHeart, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 44\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      w: \"90%\",\n      mx: \"auto\",\n      my: 12,\n      maxWidth: 1080,\n      justifyContent: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(MaterialList, {\n        title: t.coursePage.topSummaries,\n        materialArray: topMaterialsData,\n        isLoading: isLoadingTopMaterials,\n        isFetching: isFetchingTopMaterials,\n        error: errorTopMaterials\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MaterialList, {\n        title: t.coursePage.latestSummaries,\n        materialArray: latestsMaterialsData,\n        isLoading: isLoadingLatestMaterials,\n        isFetching: isFetchingLatestMaterials,\n        error: errorLatestMaterials\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }, this), !!session && /*#__PURE__*/_jsxDEV(Button, {\n      w: \"16\",\n      h: \"16\",\n      colorScheme: \"purple\",\n      position: \"fixed\",\n      bottom: \"36px\",\n      right: \"36px\",\n      alignItems: \"center\",\n      borderRadius: \"full\",\n      size: \"lg\",\n      fontSize: \"lg\",\n      onClick: onOpen,\n      children: /*#__PURE__*/_jsxDEV(Icon, {\n        as: FiPaperclip,\n        fontSize: \"32\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isCentered: true,\n      size: \"2xl\",\n      onClose: onClose,\n      isOpen: isOpen,\n      motionPreset: \"slideInBottom\",\n      blockScrollOnMount: false,\n      children: [/*#__PURE__*/_jsxDEV(ModalOverlay, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalContent, {\n        bg: \"purple.800\",\n        children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n          children: t.coursePage.form.newMaterial\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n          children: /*#__PURE__*/_jsxDEV(FormControl, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              as: \"form\",\n              flex: \"1\",\n              borderRadius: 8,\n              bg: \"purple.800\",\n              px: \"8\",\n              py: \"2\",\n              onSubmit: handleSubmit(handleCreateMaterial),\n              children: /*#__PURE__*/_jsxDEV(VStack, {\n                spacing: \"4\",\n                children: [/*#__PURE__*/_jsxDEV(Input, {\n                  name: \"name\",\n                  label: t.coursePage.form.name,\n                  description: t.coursePage.form.nameEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.name,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"description\",\n                  label: t.coursePage.form.description,\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.description,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"image\",\n                  label: t.coursePage.form.imageURL,\n                  description: t.coursePage.form.imageURLEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.image,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"link\",\n                  label: t.coursePage.form.materialLink,\n                  description: t.coursePage.form.materialLinkEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.link,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 415,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  w: \"100%\",\n                  justify: \"flex-initial\",\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    name: \"tags\",\n                    label: t.coursePage.form.tags,\n                    description: t.coursePage.form.tagsEx,\n                    descriptionColor: \"purple.300\",\n                    focusBorderColor: \"purple.600\",\n                    bg: \"purple.600\",\n                    variant: \"filled\",\n                    _hover: {\n                      bgColor: 'purple.700'\n                    },\n                    error: errors.tags,\n                    ref: register\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 431,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 430,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalFooter, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            as: \"a\",\n            colorScheme: \"whiteAlpha\",\n            variant: \"ghost\",\n            onClick: onClose,\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            colorScheme: \"purple\",\n            _hover: {\n              bgColor: 'purple.600'\n            },\n            ml: \"4\",\n            isLoading: formState.isSubmitting,\n            onClick: handleSubmit(handleCreateMaterial),\n            children: \"Create\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(CoursePage, \"L7ZdSnmfWHO5VBwdLzpcLsXNROs=\", false, function () {\n  return [useDisclosure, useSession, useToast, useLocale, useGetLatestMaterials, useGetTopLikedMaterials, useForm];\n});\n\n_c = CoursePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"CoursePage\");","map":{"version":3,"sources":["/Users/vijay/PeerNote/src/pages/community/course/[id].tsx"],"names":["Text","Img","Spacer","Button","Icon","Box","Modal","ModalOverlay","ModalContent","ModalHeader","ModalFooter","ModalBody","useDisclosure","VStack","HStack","FormControl","useToast","Head","router","useState","useEffect","useSession","useForm","yup","yupResolver","FiPaperclip","AiFillHeart","AiOutlineHeart","Input","NotFound","api","MaterialList","useGetLatestMaterials","useGetTopLikedMaterials","useLocale","incrementCourseView","createMaterialFormSchema","object","shape","name","string","max","required","description","image","url","link","tags","lowercase","min","CoursePage","singleCourseData","currentUser","courseLiked","isOpen","onOpen","onClose","liked","setLiked","session","toast","t","id","currentUserId","courseId","latestsMaterialsData","data","isLoadingLatestMaterials","isLoading","isFetchingLatestMaterials","isFetching","errorLatestMaterials","error","topMaterialsData","isLoadingTopMaterials","isFetchingTopMaterials","errorTopMaterials","resolver","register","handleSubmit","formState","errors","handleCreateMaterial","values","post","headers","type","response","Promise","resolve","setTimeout","title","coursePage","status","duration","isClosable","position","onCloseComplete","push","newMaterialId","handleLikeCourse","page404","tabMessage","course","md","sm","lg","topSummaries","latestSummaries","form","newMaterial","nameEx","bgColor","imageURL","imageURLEx","materialLink","materialLinkEx","tagsEx","isSubmitting"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable react/no-unescaped-entities */\nimport {\n  Text,\n  Img,\n  Spacer,\n  Button,\n  Icon,\n  Box,\n  Modal,\n  ModalOverlay,\n  ModalContent,\n  ModalHeader,\n  ModalFooter,\n  ModalBody,\n  useDisclosure,\n  VStack,\n  HStack,\n  FormControl,\n  useToast,\n} from '@chakra-ui/react';\nimport { GetServerSideProps } from 'next';\nimport Head from 'next/head';\nimport router from 'next/router';\nimport { useState, useEffect } from 'react';\nimport { getSession, useSession } from 'next-auth/client';\nimport { SubmitHandler, useForm } from 'react-hook-form';\nimport * as yup from 'yup';\nimport { yupResolver } from '@hookform/resolvers/yup';\n\nimport { FiPaperclip } from 'react-icons/fi';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\n\nimport { supabase } from '../../../services/supabase';\nimport { Input } from '../../../components/form/input';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\nimport { MaterialList } from '../../../components/MaterialList';\nimport {\n  useGetLatestMaterials,\n  useGetTopLikedMaterials,\n} from '../../../services/hooks/useMaterials';\nimport useLocale from '../../../services/hooks/useLocale';\nimport { incrementCourseView } from '../../../services/hooks/useCourses';\n\ntype CreateMaterialData = {\n  course_id: string;\n  name: string;\n  description: string;\n  image?: string;\n  link: string;\n  tags: string;\n  creator_id: string;\n};\n\ntype CurrentUserData = {\n  id: string;\n  name: string;\n  avatar_url: string;\n  id: number;\n};\n\ntype SingleCourseData = {\n  id: string;\n  image: string;\n  name: string;\n  description: string;\n  likes: number;\n  tags: string;\n  id: number;\n};\n\ninterface CoursePageProps {\n  singleCourseData: SingleCourseData;\n  currentUser: CurrentUserData;\n  courseLiked: boolean;\n}\n\nconst createMaterialFormSchema = yup.object().shape({\n  name: yup\n    .string()\n    .max(120, 'Maximum 120 characters')\n    .required('Wait, you would not forget the name would you?'),\n  description: yup\n    .string()\n    .max(200, 'Maximum 200 characters')\n    .required(`Don't forget the description`),\n  image: yup.string().url(),\n  link: yup.string().url().required('Material link required'),\n  tags: yup\n    .string()\n    .lowercase()\n    .min(3, 'Come on, at least 3 characters you can do it')\n    .max(144, 'Maximum 144 characters')\n    .required('Tags are important to help others to find the course :)'),\n});\n\nexport default function CoursePage({\n  singleCourseData,\n  currentUser,\n  courseLiked,\n}: CoursePageProps) {\n  const { isOpen, onOpen, onClose } = useDisclosure();\n  const [liked, setLiked] = useState(courseLiked);\n  const [session] = useSession();\n  const toast = useToast();\n  const t = useLocale();\n\n  useEffect(() => {\n    incrementCourseView(singleCourseData.id);\n  }, []);\n\n  const currentUserId = currentUser?.id;\n  const courseId = singleCourseData?.id;\n\n  const {\n    data: latestsMaterialsData,\n    isLoading: isLoadingLatestMaterials,\n    isFetching: isFetchingLatestMaterials,\n    error: errorLatestMaterials,\n  } = useGetLatestMaterials(courseId);\n\n  const {\n    data: topMaterialsData,\n    isLoading: isLoadingTopMaterials,\n    isFetching: isFetchingTopMaterials,\n    error: errorTopMaterials,\n  } = useGetTopLikedMaterials(courseId);\n\n  const { register, handleSubmit, formState, errors } = useForm({\n    resolver: yupResolver(createMaterialFormSchema),\n  });\n\n  const handleCreateMaterial: SubmitHandler<CreateMaterialData> = async values => {\n    const response = await api.post('/api/supaRequests', {\n      headers: {\n        type: 'course-create-material',\n      },\n      values,\n      currentUserId,\n      courseId,\n    });\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n\n    onClose();\n\n    toast({\n      title: `${t.coursePage.toast.title}`,\n      description: `${t.coursePage.toast.description}`,\n      status: 'success',\n      duration: 2000,\n      isClosable: true,\n      position: 'top-right',\n      onCloseComplete: () =>\n        router.push(`/community/summary/${response.data.newMaterialId}`),\n    });\n  };\n\n  const handleLikeCourse = async () => {\n    if (session) {\n      if (liked === false) {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-like-course',\n          },\n          currentUserId,\n          courseId,\n        });\n      } else {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-unlike-course',\n          },\n          currentUserId,\n          courseId,\n        });\n      }\n    }\n  };\n\n  if (singleCourseData === null) {\n    return (\n      <>\n        <Head>\n          <title>{t.page404.tabMessage}</title>\n        </Head>\n\n        <NotFound />\n      </>\n    );\n  }\n\n  const course = singleCourseData;\n\n  return (\n    <>\n      <Head>\n        <title>{course.name}</title>\n      </Head>\n\n      <Box\n        w=\"90%\"\n        mx=\"auto\"\n        display={{ md: 'flex' }}\n        maxWidth={1080}\n        marginTop={12}\n        marginBottom={4}\n        border=\"1px\"\n        borderColor=\"green.700\"\n        borderRadius=\"2xl\"\n        justifyContent=\"center\"\n      >\n        <Box\n          position=\"relative\"\n          maxHeight={{ sm: '240px', md: 'xl', lg: 'xl' }}\n          h={{ lg: 'xl', md: 'xl', sm: '240px' }}\n          w={{ sm: '100%', md: '50%', lg: '50%' }}\n          borderRadius=\"2xl\"\n        >\n          <Img\n            maxHeight={{ lg: 'xl', md: 'xl', sm: '240px' }}\n            h={{ lg: 'xl', md: 'xl', sm: '240px' }}\n            w=\"50%\"\n            boxSize=\"100%\"\n            objectFit=\"cover\"\n            src={\n              course.image !== ''\n                ? course.image\n                : '/assets/illustrations/courseImg.jpg'\n            }\n            fallbac=\"/assets/illustrations/courseImg.jpg\"\n            alt=\"Course Image\"\n            borderRadius=\"2xl\"\n          />\n        </Box>\n\n        <VStack\n          h={{ md: 'xl', sm: 'md' }}\n          w={{ sm: '100%', md: '50%', lg: '50%' }}\n          bg=\"purple.900\"\n          minWidth={{ md: '50%', lg: '50%' }}\n          alignItems=\"left\"\n          borderBottomRadius=\"2xl\"\n          borderTopRightRadius=\"2xl\"\n        >\n          <Text\n            mb={['1', '2', '4']}\n            fontWeight=\"700\"\n            fontSize={['xl', '2xl', '3xl']}\n            lineHeight=\"9\"\n            px={['6', '8']}\n            pt={['2', '3', '6']}\n          >\n            {course.name}\n          </Text>\n\n          <Text\n            px={['6', '8']}\n            lineHeight=\"5\"\n            color=\"green.600\"\n            noOfLines={6}\n            fontSize={['sm', 'md', 'lg']}\n          >\n            {course.description}\n          </Text>\n\n          <Spacer />\n          {/*\n          <Box px=\"8\">\n            <Text fontWeight=\"200\" fontSize={['lg', 'xl']} color=\"gray.300\">\n              <strong>{course.buddys_coursing}</strong> Buddy's est√£o fazendo\n              esse curso\n            </Text>\n\n            <Button\n              size=\"md\"\n              mt=\"4\"\n              colorScheme=\"purple\"\n              color=\"purple.900\"\n              _focus={{ boxShadow: 'none' }}\n              _hover={{ bg: 'purple.550' }}\n            >\n              Ver Buddy's\n            </Button>\n          </Box> */}\n          <Box align=\"right\" w=\"100%\">\n            <HStack\n              w=\"16\"\n              bgColor=\"green.900\"\n              borderBottomRightRadius=\"2xl\"\n              borderTopLeftRadius=\"2xl\"\n            >\n              <Button\n                pl=\"5\"\n                size=\"lg\"\n                color=\"green.500\"\n                variant=\"unstyled\"\n                fontSize=\"2xl\"\n                justifyContent=\"center\"\n                onClick={handleLikeCourse}\n                isDisabled={!session}\n              >\n                {liked ? <AiFillHeart /> : <AiOutlineHeart />}\n              </Button>\n            </HStack>\n          </Box>\n        </VStack>\n      </Box>\n\n      <Box w=\"90%\" mx=\"auto\" my={12} maxWidth={1080} justifyContent=\"center\">\n        <MaterialList\n          title={t.coursePage.topSummaries}\n          materialArray={topMaterialsData}\n          isLoading={isLoadingTopMaterials}\n          isFetching={isFetchingTopMaterials}\n          error={errorTopMaterials}\n        />\n\n        <MaterialList\n          title={t.coursePage.latestSummaries}\n          materialArray={latestsMaterialsData}\n          isLoading={isLoadingLatestMaterials}\n          isFetching={isFetchingLatestMaterials}\n          error={errorLatestMaterials}\n        />\n      </Box>\n\n      {!!session && (\n        <Button\n          w=\"16\"\n          h=\"16\"\n          colorScheme=\"purple\"\n          position=\"fixed\"\n          bottom=\"36px\"\n          right=\"36px\"\n          alignItems=\"center\"\n          borderRadius=\"full\"\n          size=\"lg\"\n          fontSize=\"lg\"\n          onClick={onOpen}\n        >\n          <Icon as={FiPaperclip} fontSize=\"32\" />\n        </Button>\n      )}\n\n      <Modal\n        isCentered\n        size=\"2xl\"\n        onClose={onClose}\n        isOpen={isOpen}\n        motionPreset=\"slideInBottom\"\n        blockScrollOnMount={false}\n      >\n        <ModalOverlay />\n        <ModalContent bg=\"purple.800\">\n          <ModalHeader>{t.coursePage.form.newMaterial}</ModalHeader>\n          <ModalBody>\n            <FormControl>\n              <Box\n                as=\"form\"\n                flex=\"1\"\n                borderRadius={8}\n                bg=\"purple.800\"\n                px=\"8\"\n                py=\"2\"\n                onSubmit={handleSubmit(handleCreateMaterial)}\n              >\n                <VStack spacing=\"4\">\n                  <Input\n                    name=\"name\"\n                    label={t.coursePage.form.name}\n                    description={t.coursePage.form.nameEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.name}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"description\"\n                    label={t.coursePage.form.description}\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.description}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"image\"\n                    label={t.coursePage.form.imageURL}\n                    description={t.coursePage.form.imageURLEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.image}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"link\"\n                    label={t.coursePage.form.materialLink}\n                    description={t.coursePage.form.materialLinkEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.link}\n                    ref={register}\n                  />\n\n                  <Box w=\"100%\" justify=\"flex-initial\">\n                    <Input\n                      name=\"tags\"\n                      label={t.coursePage.form.tags}\n                      description={t.coursePage.form.tagsEx}\n                      descriptionColor=\"purple.300\"\n                      focusBorderColor=\"purple.600\"\n                      bg=\"purple.600\"\n                      variant=\"filled\"\n                      _hover={{\n                        bgColor: 'purple.700',\n                      }}\n                      error={errors.tags}\n                      ref={register}\n                    />\n                  </Box>\n                </VStack>\n              </Box>\n            </FormControl>\n          </ModalBody>\n          <ModalFooter>\n            <Button\n              as=\"a\"\n              colorScheme=\"whiteAlpha\"\n              variant=\"ghost\"\n              onClick={onClose}\n            >\n              Close\n            </Button>\n            <Button\n              type=\"submit\"\n              colorScheme=\"purple\"\n              _hover={{\n                bgColor: 'purple.600',\n              }}\n              ml=\"4\"\n              isLoading={formState.isSubmitting}\n              onClick={handleSubmit(handleCreateMaterial)}\n            >\n              Create\n            </Button>\n          </ModalFooter>\n        </ModalContent>\n      </Modal>\n    </>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = async ({\n  params,\n  req,\n}) => {\n  const { id: id } = params;\n  const session = await getSession({ req });\n\n  const currentUserEmail = session?.user.email;\n\n  const { data: currentUser } = await supabase\n    .from('users')\n    .select('id, name, email, avatar_url, id')\n    .eq('email', `${currentUserEmail}`)\n    .single();\n\n  const { data: singleCourseData } = await supabase\n    .from('courses')\n    .select(\n      'id, id, name, image, likes, id, description, tags'\n    )\n    .eq('id', String(id))\n    .single();\n\n  const { data: materialsArray } = await supabase\n    .from('materials')\n    .select(\n      `\n    *,\n    users: user_id ( name )\n  `\n    )\n    .eq('course_id', String(singleCourseData?.id));\n\n  const { data: liked } = await supabase\n    .from('course_likes')\n    .select(\n      `\n        *,\n        users: user_id ( name )\n        `\n    )\n    .eq('course_id', String(singleCourseData?.id))\n    .eq('user_id', String(currentUser?.id))\n    .single();\n\n  const courseLiked = liked !== null;\n  return {\n    props: {\n      singleCourseData,\n      materialsArray,\n      currentUser,\n      courseLiked,\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}