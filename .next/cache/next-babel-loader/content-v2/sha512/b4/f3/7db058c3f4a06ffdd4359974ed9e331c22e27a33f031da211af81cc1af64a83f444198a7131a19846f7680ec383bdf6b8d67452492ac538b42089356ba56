{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/vijay/PeerNote/src/pages/community/summary/[id].tsx\";\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { Text, Box, Flex, VStack, HStack, Spacer, Button, Img, Icon, Link as ChakraLink, useToast } from '@chakra-ui/react';\nimport { useState } from 'react';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { getSession, useSession } from 'next-auth/client';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\nimport { FiExternalLink } from 'react-icons/fi';\nimport { supabase } from '../../../services/supabase';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\nexport default function Material({\n  singleMaterialData: material,\n  materialLiked,\n  currentUserData,\n  notUser = false\n}) {\n  const {\n    0: liked,\n    1: setLiked\n  } = useState(materialLiked);\n  const toast = useToast();\n  const session = useSession();\n  const currentUserId = currentUserData === null || currentUserData === void 0 ? void 0 : currentUserData.id;\n  const materialId = material === null || material === void 0 ? void 0 : material.id;\n\n  const handleLikeMaterial = async () => {\n    // try {\n    if (session) {\n      if (liked === false) {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'RESUME-like-material'\n          },\n          currentUserId,\n          materialId\n        });\n      } else {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'RESUME-unlike-material'\n          },\n          currentUserId,\n          materialId\n        });\n      }\n    } else {\n      toast({\n        title: 'Error',\n        description: 'You must be logged in to like and organize your materials ðŸ˜Š',\n        status: 'error',\n        position: 'top-left',\n        duration: 6000,\n        isClosable: true\n      });\n    } // } catch {\n    //   throw Error;\n    // }\n\n  };\n\n  if (material === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Head, {\n        children: /*#__PURE__*/_jsxDEV(\"title\", {\n          children: \"404 material page\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: material.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Flex, {\n      w: \"100%\",\n      h: \"calc(100vh - 6rem)\",\n      py: {\n        base: '0',\n        md: '20'\n      },\n      align: \"center\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        display: {\n          md: 'flex'\n        },\n        width: \"90%\",\n        maxWidth: 1080,\n        mx: \"auto\",\n        alignSelf: \"center\",\n        border: \"1px\",\n        borderColor: \"purple.500\",\n        borderRadius: \"2xl\",\n        justifyContent: \"center\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          position: \"relative\",\n          maxHeight: {\n            sm: '240px',\n            md: 'lg',\n            lg: 'lg'\n          },\n          h: {\n            lg: 'lg',\n            md: 'lg',\n            sm: '240px'\n          },\n          w: {\n            sm: '100%',\n            md: '50%',\n            lg: '50%'\n          },\n          borderRadius: \"2xl\",\n          children: [/*#__PURE__*/_jsxDEV(Img, {\n            maxHeight: {\n              lg: 'lg',\n              md: 'lg',\n              sm: '240px'\n            },\n            h: {\n              lg: 'lg',\n              md: 'lg',\n              sm: '240px'\n            },\n            w: \"50%\",\n            boxSize: \"100%\",\n            objectFit: \"cover\",\n            src: material.image !== '' ? material.image : '/assets/illustrations/MaterialImageSource.svg',\n            fallback: \"/assets/illustrations/MaterialImageSource.svg\",\n            alt: \"Course Image\",\n            borderRadius: \"2xl\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(VStack, {\n            position: \"absolute\",\n            bottom: \"20px\",\n            px: ['4', '4', '8'],\n            py: ['2', '4', '4'],\n            bg: \"purple.900\",\n            alignItems: \"left\",\n            borderRightRadius: \"16\",\n            spacing: \"1/4\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              fontSize: ['sm', 'sm', 'md'],\n              fontWeight: \"400\",\n              fontStyle: \"Italic\",\n              color: \"purple.500\",\n              children: \"By:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Text, {\n              fontWeight: \"600\",\n              fontSize: ['md', 'lg', 'xl'],\n              children: material.users.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(VStack, {\n          bg: \"purple.900\",\n          h: {\n            md: 'lg',\n            sm: 'md'\n          },\n          w: {\n            sm: '100%',\n            md: '50%',\n            lg: '50%'\n          },\n          minWidth: {\n            md: '50%',\n            lg: '50%'\n          },\n          alignItems: \"left\",\n          borderBottomRadius: \"2xl\",\n          borderTopRightRadius: \"2xl\",\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            mb: ['1', '2', '4'],\n            fontWeight: \"700\",\n            fontSize: ['xl', '2xl', '3xl'],\n            lineHeight: \"9\",\n            px: ['6', '8'],\n            pt: ['2', '3', '6'],\n            children: material.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            px: ['6', '8'],\n            lineHeight: \"5\",\n            color: \"purple.500\",\n            noOfLines: 6,\n            fontSize: ['sm', 'md', 'lg'],\n            children: material.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Spacer, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            px: \"8\",\n            children: [/*#__PURE__*/_jsxDEV(Text, {\n              fontWeight: \"400\",\n              fontStyle: \"Italic\",\n              color: \"purple.500\",\n              mb: \"1\",\n              children: \"Link:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              px: \"4\",\n              py: \"2\",\n              borderRadius: \"2xl\",\n              border: \"1px\",\n              borderColor: \"purple.500\",\n              children: /*#__PURE__*/_jsxDEV(Text, {\n                fontWeight: \"200\",\n                fontSize: ['lg', 'xl'],\n                color: \"gray.700\",\n                noOfLines: 2,\n                as: \"abbr\",\n                children: material.link\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Flex, {\n              align: \"center\",\n              justify: \"end\",\n              mt: \"4\",\n              mb: \"4\",\n              w: \"100%\",\n              children: [/*#__PURE__*/_jsxDEV(Link, {\n                href: `/community/course/${material.courses.id}`,\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  size: \"md\",\n                  colorScheme: \"purple\",\n                  color: \"purple.500\",\n                  h: \"10\",\n                  mr: \"4\",\n                  variant: \"outline\",\n                  _hover: {\n                    bg: 'purple.700'\n                  },\n                  children: \"Course Page\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ChakraLink, {\n                href: material.link,\n                isExternal: true,\n                h: \"10\",\n                _hover: {\n                  textDecoration: 'none'\n                },\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  size: \"md\",\n                  colorScheme: \"purple\",\n                  color: \"purple.900\",\n                  _focus: {\n                    boxShadow: 'none'\n                  },\n                  _hover: {\n                    bg: 'purple.550'\n                  },\n                  children: [\"Go to Link\", /*#__PURE__*/_jsxDEV(Icon, {\n                    ml: \"2\",\n                    mt: \"2\",\n                    h: \"6\",\n                    w: \"6\",\n                    align: \"center\",\n                    children: /*#__PURE__*/_jsxDEV(FiExternalLink, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 280,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            align: \"right\",\n            w: \"100%\",\n            children: /*#__PURE__*/_jsxDEV(HStack, {\n              w: \"16\",\n              bgColor: \"purple.800\",\n              borderBottomRightRadius: \"2xl\",\n              borderTopLeftRadius: \"2xl\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                pl: \"5\",\n                size: \"lg\",\n                color: \"purple.500\",\n                variant: \"unstyled\",\n                fontSize: \"2xl\",\n                justifyContent: \"center\",\n                onClick: handleLikeMaterial,\n                isDisabled: notUser,\n                children: liked ? /*#__PURE__*/_jsxDEV(AiFillHeart, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 28\n                }, this) : /*#__PURE__*/_jsxDEV(AiOutlineHeart, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 46\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\nexport const getServerSideProps = async ({\n  params,\n  req\n}) => {\n  const {\n    id\n  } = params;\n  const session = await getSession({\n    req\n  });\n\n  if (session) {\n    const currentUserEmail = session.user.email;\n    const {\n      data: currentUserData\n    } = await supabase.from('users').select('id, name, email, avatar_url, id').eq('email', `${currentUserEmail}`).single();\n    const {\n      data: singleMaterialData\n    } = await supabase.from('materials').select(`\n        id, name, description, image, link, tags, creator_id, created_at,\n        users: creator_id ( name ),\n        courses: course_id ( id )\n        `).eq('id', String(id)).single(); // console.log(JSON.stringify(singleMaterialData, null, 2))\n\n    const {\n      data: liked\n    } = await supabase.from('material_likes').select(`\n      *,\n      users: user_id ( name )\n      `).eq('material_id', String(id)).eq('user_id', String(currentUserData.id)).single();\n    const materialLiked = liked !== null;\n    return {\n      props: {\n        singleMaterialData,\n        currentUserData,\n        materialLiked\n      }\n    };\n  } // if user not logged in\n\n\n  const {\n    data: singleMaterialData\n  } = await supabase.from('materials').select(`\n      id, name, description, image, link, tags, creator_id, created_at,\n      users: creator_id ( name ),\n      courses: course_id ( id )\n    `).eq('id', String(id)).single();\n  const notUser = true;\n  return {\n    props: {\n      singleMaterialData,\n      notUser\n    }\n  };\n};","map":{"version":3,"sources":["/Users/vijay/PeerNote/src/pages/community/summary/[id].tsx"],"names":["Text","Box","Flex","VStack","HStack","Spacer","Button","Img","Icon","Link","ChakraLink","useToast","useState","Head","getSession","useSession","AiFillHeart","AiOutlineHeart","FiExternalLink","supabase","NotFound","api","Material","singleMaterialData","material","materialLiked","currentUserData","notUser","liked","setLiked","toast","session","currentUserId","id","materialId","handleLikeMaterial","response","post","headers","type","title","description","status","position","duration","isClosable","name","base","md","sm","lg","image","users","link","courses","bg","textDecoration","boxShadow","getServerSideProps","params","req","currentUserEmail","user","email","data","from","select","eq","single","String","props"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport {\n  Text,\n  Box,\n  Flex,\n  VStack,\n  HStack,\n  Spacer,\n  Button,\n  Img,\n  Icon,\n  Link as ChakraLink,\n  useToast,\n} from '@chakra-ui/react';\nimport { useState } from 'react';\nimport { GetServerSideProps } from 'next';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { getSession, useSession } from 'next-auth/client';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\nimport { FiExternalLink } from 'react-icons/fi';\n\nimport { supabase } from '../../../services/supabase';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\n\ntype CurrentUserData = {\n  id: string;\n  name: string;\n  avatar_url: string;\n  id: number;\n};\n\ntype MaterialProps = {\n  id: string;\n  name: string;\n  description: string;\n  image: string;\n  link: string;\n  tags: string;\n  creator_id: string;\n  created_at: string;\n  users: {\n    name: string;\n  };\n  courses: {\n    id: number;\n  };\n};\n\ninterface SummaryPageProps {\n  singleMaterialData: MaterialProps;\n  materialLiked: boolean;\n  currentUserData: CurrentUserData;\n  notUser: boolean;\n}\n\nexport default function Material({\n  singleMaterialData: material,\n  materialLiked,\n  currentUserData,\n  notUser = false,\n}: SummaryPageProps) {\n  const [liked, setLiked] = useState(materialLiked);\n  const toast = useToast();\n  const session = useSession();\n\n  const currentUserId = currentUserData?.id;\n  const materialId = material?.id;\n\n  const handleLikeMaterial = async () => {\n    // try {\n    if (session) {\n      if (liked === false) {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'RESUME-like-material',\n          },\n          currentUserId,\n          materialId,\n        });\n      } else {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'RESUME-unlike-material',\n          },\n          currentUserId,\n          materialId,\n        });\n      }\n    } else {\n      toast({\n        title: 'Error',\n        description:\n          'You must be logged in to like and organize your materials ðŸ˜Š',\n        status: 'error',\n        position: 'top-left',\n        duration: 6000,\n        isClosable: true,\n      });\n    }\n    // } catch {\n    //   throw Error;\n    // }\n  };\n\n  if (material === null) {\n    return (\n      <>\n        <Head>\n          <title>404 material page</title>\n        </Head>\n\n        <NotFound />\n      </>\n    );\n  }\n\n  return (\n    <>\n      <Head>\n        <title>{material.name}</title>\n      </Head>\n\n      <Flex\n        w=\"100%\"\n        h=\"calc(100vh - 6rem)\"\n        py={{ base: '0', md: '20' }}\n        align=\"center\"\n      >\n        <Box\n          display={{ md: 'flex' }}\n          width=\"90%\"\n          maxWidth={1080}\n          mx=\"auto\"\n          alignSelf=\"center\"\n          border=\"1px\"\n          borderColor=\"purple.500\"\n          borderRadius=\"2xl\"\n          justifyContent=\"center\"\n        >\n          <Box\n            position=\"relative\"\n            maxHeight={{ sm: '240px', md: 'lg', lg: 'lg' }}\n            h={{ lg: 'lg', md: 'lg', sm: '240px' }}\n            w={{ sm: '100%', md: '50%', lg: '50%' }}\n            borderRadius=\"2xl\"\n          >\n            <Img\n              maxHeight={{ lg: 'lg', md: 'lg', sm: '240px' }}\n              h={{ lg: 'lg', md: 'lg', sm: '240px' }}\n              w=\"50%\"\n              boxSize=\"100%\"\n              objectFit=\"cover\"\n              src={\n                material.image !== ''\n                  ? material.image\n                  : '/assets/illustrations/MaterialImageSource.svg'\n              }\n              fallback=\"/assets/illustrations/MaterialImageSource.svg\"\n              alt=\"Course Image\"\n              borderRadius=\"2xl\"\n            />\n\n            <VStack\n              position=\"absolute\"\n              bottom=\"20px\"\n              px={['4', '4', '8']}\n              py={['2', '4', '4']}\n              bg=\"purple.900\"\n              alignItems=\"left\"\n              borderRightRadius=\"16\"\n              spacing=\"1/4\"\n            >\n              <Text\n                fontSize={['sm', 'sm', 'md']}\n                fontWeight=\"400\"\n                fontStyle=\"Italic\"\n                color=\"purple.500\"\n              >\n                By:\n              </Text>\n              <Text fontWeight=\"600\" fontSize={['md', 'lg', 'xl']}>\n                {material.users.name}\n              </Text>\n            </VStack>\n          </Box>\n\n          <VStack\n            bg=\"purple.900\"\n            h={{ md: 'lg', sm: 'md' }}\n            w={{ sm: '100%', md: '50%', lg: '50%' }}\n            minWidth={{ md: '50%', lg: '50%' }}\n            alignItems=\"left\"\n            borderBottomRadius=\"2xl\"\n            borderTopRightRadius=\"2xl\"\n          >\n            <Text\n              mb={['1', '2', '4']}\n              fontWeight=\"700\"\n              fontSize={['xl', '2xl', '3xl']}\n              lineHeight=\"9\"\n              px={['6', '8']}\n              pt={['2', '3', '6']}\n            >\n              {material.name}\n            </Text>\n\n            <Text\n              px={['6', '8']}\n              lineHeight=\"5\"\n              color=\"purple.500\"\n              noOfLines={6}\n              fontSize={['sm', 'md', 'lg']}\n            >\n              {material.description}\n            </Text>\n\n            <Spacer />\n\n            <Box px=\"8\">\n              <Text\n                fontWeight=\"400\"\n                fontStyle=\"Italic\"\n                color=\"purple.500\"\n                mb=\"1\"\n              >\n                Link:\n              </Text>\n              <Box\n                px=\"4\"\n                py=\"2\"\n                borderRadius=\"2xl\"\n                border=\"1px\"\n                borderColor=\"purple.500\"\n              >\n                <Text\n                  fontWeight=\"200\"\n                  fontSize={['lg', 'xl']}\n                  color=\"gray.700\"\n                  noOfLines={2}\n                  as=\"abbr\"\n                >\n                  {material.link}\n                </Text>\n              </Box>\n\n              <Flex align=\"center\" justify=\"end\" mt=\"4\" mb=\"4\" w=\"100%\">\n                <Link href={`/community/course/${material.courses.id}`}>\n                  <Button\n                    size=\"md\"\n                    colorScheme=\"purple\"\n                    color=\"purple.500\"\n                    h=\"10\"\n                    mr=\"4\"\n                    variant=\"outline\"\n                    _hover={{ bg: 'purple.700' }}\n                  >\n                    Course Page\n                  </Button>\n                </Link>\n\n                <ChakraLink\n                  href={material.link}\n                  isExternal\n                  h=\"10\"\n                  _hover={{ textDecoration: 'none' }}\n                >\n                  <Button\n                    size=\"md\"\n                    colorScheme=\"purple\"\n                    color=\"purple.900\"\n                    _focus={{ boxShadow: 'none' }}\n                    _hover={{ bg: 'purple.550' }}\n                  >\n                    Go to Link\n                    <Icon ml=\"2\" mt=\"2\" h=\"6\" w=\"6\" align=\"center\">\n                      <FiExternalLink />\n                    </Icon>\n                  </Button>\n                </ChakraLink>\n              </Flex>\n            </Box>\n            <Box align=\"right\" w=\"100%\">\n              <HStack\n                w=\"16\"\n                bgColor=\"purple.800\"\n                borderBottomRightRadius=\"2xl\"\n                borderTopLeftRadius=\"2xl\"\n              >\n                <Button\n                  pl=\"5\"\n                  size=\"lg\"\n                  color=\"purple.500\"\n                  variant=\"unstyled\"\n                  fontSize=\"2xl\"\n                  justifyContent=\"center\"\n                  onClick={handleLikeMaterial}\n                  isDisabled={notUser}\n                >\n                  {liked ? <AiFillHeart /> : <AiOutlineHeart />}\n                </Button>\n              </HStack>\n            </Box>\n          </VStack>\n        </Box>\n      </Flex>\n\n      {/* <Box\n        width=\"90%\"\n        maxWidth={1080}\n        mx=\"auto\"\n        my={12}\n        justifyContent=\"center\"\n      /> */}\n    </>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = async ({\n  params,\n  req,\n}) => {\n  const { id } = params;\n  const session = await getSession({ req });\n\n  if (session) {\n    const currentUserEmail = session.user.email;\n\n    const { data: currentUserData } = await supabase\n      .from('users')\n      .select('id, name, email, avatar_url, id')\n      .eq('email', `${currentUserEmail}`)\n      .single();\n\n    const { data: singleMaterialData } = await supabase\n      .from('materials')\n      .select(\n        `\n        id, name, description, image, link, tags, creator_id, created_at,\n        users: creator_id ( name ),\n        courses: course_id ( id )\n        `\n      )\n      .eq('id', String(id))\n      .single();\n\n    // console.log(JSON.stringify(singleMaterialData, null, 2))\n\n    const { data: liked } = await supabase\n      .from('material_likes')\n      .select(\n        `\n      *,\n      users: user_id ( name )\n      `\n      )\n      .eq('material_id', String(id))\n      .eq('user_id', String(currentUserData.id))\n      .single();\n\n    const materialLiked = liked !== null;\n\n    return {\n      props: {\n        singleMaterialData,\n        currentUserData,\n        materialLiked,\n      },\n    };\n  }\n\n  // if user not logged in\n  const { data: singleMaterialData } = await supabase\n    .from('materials')\n    .select(\n      `\n      id, name, description, image, link, tags, creator_id, created_at,\n      users: creator_id ( name ),\n      courses: course_id ( id )\n    `\n    )\n    .eq('id', String(id))\n    .single();\n\n  const notUser = true;\n\n  return {\n    props: {\n      singleMaterialData,\n      notUser,\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}