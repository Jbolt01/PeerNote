{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/vijay/PeerNote/src/pages/community/course/[id].tsx\";\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\n\n/* eslint-disable react/no-unescaped-entities */\nimport { Text, Img, Spacer, Button, Icon, Box, Modal, ModalOverlay, ModalContent, ModalHeader, ModalFooter, ModalBody, useDisclosure, VStack, HStack, FormControl, useToast } from '@chakra-ui/react';\nimport Head from 'next/head';\nimport router from 'next/router';\nimport { useState, useEffect } from 'react';\nimport { getSession, useSession } from 'next-auth/client';\nimport { useForm } from 'react-hook-form';\nimport * as yup from 'yup';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport { FiPaperclip } from 'react-icons/fi';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\nimport { supabase } from '../../../services/supabase';\nimport { Input } from '../../../components/form/input';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\nimport { MaterialList } from '../../../components/MaterialList';\nimport { useGetLatestMaterials, useGetTopLikedMaterials } from '../../../services/hooks/useMaterials';\nimport useLocale from '../../../services/hooks/useLocale';\nimport { incrementCourseView } from '../../../services/hooks/useCourses';\nconst createMaterialFormSchema = yup.object().shape({\n  name: yup.string().max(120, 'Maximum 120 characters').required('Wait, you would not forget the name would you?'),\n  description: yup.string().max(200, 'Maximum 200 characters').required(`Don't forget the description`),\n  image: yup.string().url(),\n  link: yup.string().url().required('Material link required'),\n  tags: yup.string().lowercase().min(3, 'Come on, at least 3 characters you can do it').max(144, 'Maximum 144 characters').required('Tags are important to help others to find the course :)')\n});\nexport default function CoursePage({\n  singleCourseData,\n  currentUser,\n  courseLiked\n}) {\n  const {\n    isOpen,\n    onOpen,\n    onClose\n  } = useDisclosure();\n  const {\n    0: liked,\n    1: setLiked\n  } = useState(courseLiked);\n  const [session] = useSession();\n  const toast = useToast();\n  const t = useLocale();\n  useEffect(() => {\n    incrementCourseView(singleCourseData.id);\n  }, []);\n  const currentUserId = currentUser === null || currentUser === void 0 ? void 0 : currentUser.id;\n  const courseId = singleCourseData === null || singleCourseData === void 0 ? void 0 : singleCourseData.id;\n  const {\n    data: latestsMaterialsData,\n    isLoading: isLoadingLatestMaterials,\n    isFetching: isFetchingLatestMaterials,\n    error: errorLatestMaterials\n  } = useGetLatestMaterials(courseId);\n  const {\n    data: topMaterialsData,\n    isLoading: isLoadingTopMaterials,\n    isFetching: isFetchingTopMaterials,\n    error: errorTopMaterials\n  } = useGetTopLikedMaterials(courseId);\n  const {\n    register,\n    handleSubmit,\n    formState,\n    errors\n  } = useForm({\n    resolver: yupResolver(createMaterialFormSchema)\n  });\n\n  const handleCreateMaterial = async values => {\n    const response = await api.post('/api/supaRequests', {\n      headers: {\n        type: 'course-create-material'\n      },\n      values,\n      currentUserId,\n      courseId\n    });\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    onClose();\n    toast({\n      title: `${t.coursePage.toast.title}`,\n      description: `${t.coursePage.toast.description}`,\n      status: 'success',\n      duration: 2000,\n      isClosable: true,\n      position: 'top-right',\n      onCloseComplete: () => router.push(`/community/summary/${response.data.newMaterialId}`)\n    });\n  };\n\n  const handleLikeCourse = async () => {\n    if (session) {\n      if (liked === false) {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-like-course'\n          },\n          currentUserId,\n          courseId\n        });\n      } else {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-unlike-course'\n          },\n          currentUserId,\n          courseId\n        });\n      }\n    }\n  };\n\n  if (singleCourseData === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Head, {\n        children: /*#__PURE__*/_jsxDEV(\"title\", {\n          children: t.page404.tabMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  const course = singleCourseData;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: course.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      w: \"90%\",\n      mx: \"auto\",\n      display: {\n        md: 'flex'\n      },\n      maxWidth: 1080,\n      marginTop: 12,\n      marginBottom: 4,\n      border: \"1px\",\n      borderColor: \"green.700\",\n      borderRadius: \"2xl\",\n      justifyContent: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        position: \"relative\",\n        maxHeight: {\n          sm: '240px',\n          md: 'xl',\n          lg: 'xl'\n        },\n        h: {\n          lg: 'xl',\n          md: 'xl',\n          sm: '240px'\n        },\n        w: {\n          sm: '100%',\n          md: '50%',\n          lg: '50%'\n        },\n        borderRadius: \"2xl\",\n        children: /*#__PURE__*/_jsxDEV(Img, {\n          maxHeight: {\n            lg: 'xl',\n            md: 'xl',\n            sm: '240px'\n          },\n          h: {\n            lg: 'xl',\n            md: 'xl',\n            sm: '240px'\n          },\n          w: \"50%\",\n          boxSize: \"100%\",\n          objectFit: \"cover\",\n          src: course.image !== '' ? course.image : '/assets/illustrations/courseImg.jpg',\n          fallbac: \"/assets/illustrations/courseImg.jpg\",\n          alt: \"Course Image\",\n          borderRadius: \"2xl\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(VStack, {\n        h: {\n          md: 'xl',\n          sm: 'md'\n        },\n        w: {\n          sm: '100%',\n          md: '50%',\n          lg: '50%'\n        },\n        bg: \"purple.900\",\n        minWidth: {\n          md: '50%',\n          lg: '50%'\n        },\n        alignItems: \"left\",\n        borderBottomRadius: \"2xl\",\n        borderTopRightRadius: \"2xl\",\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          mb: ['1', '2', '4'],\n          fontWeight: \"700\",\n          fontSize: ['xl', '2xl', '3xl'],\n          lineHeight: \"9\",\n          px: ['6', '8'],\n          pt: ['2', '3', '6'],\n          children: course.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          px: ['6', '8'],\n          lineHeight: \"5\",\n          color: \"green.600\",\n          noOfLines: 6,\n          fontSize: ['sm', 'md', 'lg'],\n          children: course.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Spacer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          align: \"right\",\n          w: \"100%\",\n          children: /*#__PURE__*/_jsxDEV(HStack, {\n            w: \"16\",\n            bgColor: \"green.900\",\n            borderBottomRightRadius: \"2xl\",\n            borderTopLeftRadius: \"2xl\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              pl: \"5\",\n              size: \"lg\",\n              color: \"green.500\",\n              variant: \"unstyled\",\n              fontSize: \"2xl\",\n              justifyContent: \"center\",\n              onClick: handleLikeCourse,\n              isDisabled: !session,\n              children: liked ? /*#__PURE__*/_jsxDEV(AiFillHeart, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 26\n              }, this) : /*#__PURE__*/_jsxDEV(AiOutlineHeart, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 44\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      w: \"90%\",\n      mx: \"auto\",\n      my: 12,\n      maxWidth: 1080,\n      justifyContent: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(MaterialList, {\n        title: t.coursePage.topSummaries,\n        materialArray: topMaterialsData,\n        isLoading: isLoadingTopMaterials,\n        isFetching: isFetchingTopMaterials,\n        error: errorTopMaterials\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MaterialList, {\n        title: t.coursePage.latestSummaries,\n        materialArray: latestsMaterialsData,\n        isLoading: isLoadingLatestMaterials,\n        isFetching: isFetchingLatestMaterials,\n        error: errorLatestMaterials\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }, this), !!session && /*#__PURE__*/_jsxDEV(Button, {\n      w: \"16\",\n      h: \"16\",\n      colorScheme: \"purple\",\n      position: \"fixed\",\n      bottom: \"36px\",\n      right: \"36px\",\n      alignItems: \"center\",\n      borderRadius: \"full\",\n      size: \"lg\",\n      fontSize: \"lg\",\n      onClick: onOpen,\n      children: /*#__PURE__*/_jsxDEV(Icon, {\n        as: FiPaperclip,\n        fontSize: \"32\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isCentered: true,\n      size: \"2xl\",\n      onClose: onClose,\n      isOpen: isOpen,\n      motionPreset: \"slideInBottom\",\n      blockScrollOnMount: false,\n      children: [/*#__PURE__*/_jsxDEV(ModalOverlay, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalContent, {\n        bg: \"purple.800\",\n        children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n          children: t.coursePage.form.newMaterial\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n          children: /*#__PURE__*/_jsxDEV(FormControl, {\n            children: /*#__PURE__*/_jsxDEV(Box, {\n              as: \"form\",\n              flex: \"1\",\n              borderRadius: 8,\n              bg: \"purple.800\",\n              px: \"8\",\n              py: \"2\",\n              onSubmit: handleSubmit(handleCreateMaterial),\n              children: /*#__PURE__*/_jsxDEV(VStack, {\n                spacing: \"4\",\n                children: [/*#__PURE__*/_jsxDEV(Input, {\n                  name: \"name\",\n                  label: t.coursePage.form.name,\n                  description: t.coursePage.form.nameEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.name,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"description\",\n                  label: t.coursePage.form.description,\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.description,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 387,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"image\",\n                  label: t.coursePage.form.imageURL,\n                  description: t.coursePage.form.imageURLEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.image,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  name: \"link\",\n                  label: t.coursePage.form.materialLink,\n                  description: t.coursePage.form.materialLinkEx,\n                  descriptionColor: \"purple.300\",\n                  focusBorderColor: \"purple.600\",\n                  bg: \"purple.600\",\n                  variant: \"filled\",\n                  _hover: {\n                    bgColor: 'purple.700'\n                  },\n                  error: errors.link,\n                  ref: register\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 415,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Box, {\n                  w: \"100%\",\n                  justify: \"flex-initial\",\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    name: \"tags\",\n                    label: t.coursePage.form.tags,\n                    description: t.coursePage.form.tagsEx,\n                    descriptionColor: \"purple.300\",\n                    focusBorderColor: \"purple.600\",\n                    bg: \"purple.600\",\n                    variant: \"filled\",\n                    _hover: {\n                      bgColor: 'purple.700'\n                    },\n                    error: errors.tags,\n                    ref: register\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 431,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 430,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalFooter, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            as: \"a\",\n            colorScheme: \"whiteAlpha\",\n            variant: \"ghost\",\n            onClick: onClose,\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            colorScheme: \"purple\",\n            _hover: {\n              bgColor: 'purple.600'\n            },\n            ml: \"4\",\n            isLoading: formState.isSubmitting,\n            onClick: handleSubmit(handleCreateMaterial),\n            children: \"Create\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\nexport const getServerSideProps = async ({\n  params,\n  req\n}) => {\n  const {\n    id: id\n  } = params;\n  const session = await getSession({\n    req\n  });\n  const currentUserEmail = session === null || session === void 0 ? void 0 : session.user.email;\n  const {\n    data: currentUser\n  } = await supabase.from('users').select('id, name, email, avatar_url, id').eq('email', `${currentUserEmail}`).single();\n  const {\n    data: singleCourseData\n  } = await supabase.from('courses').select('id, id, name, image, likes, id, description, tags').eq('id', String(id)).single();\n  const {\n    data: materialsArray\n  } = await supabase.from('materials').select(`\n    *,\n    users: user_id ( name )\n  `).eq('course_id', String(singleCourseData === null || singleCourseData === void 0 ? void 0 : singleCourseData.id));\n  const {\n    data: liked\n  } = await supabase.from('course_likes').select(`\n        *,\n        users: user_id ( name )\n        `).eq('course_id', String(singleCourseData === null || singleCourseData === void 0 ? void 0 : singleCourseData.id)).eq('user_id', String(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id)).single();\n  const courseLiked = liked !== null;\n  return {\n    props: {\n      singleCourseData,\n      materialsArray,\n      currentUser,\n      courseLiked\n    }\n  };\n};","map":{"version":3,"sources":["/Users/vijay/PeerNote/src/pages/community/course/[id].tsx"],"names":["Text","Img","Spacer","Button","Icon","Box","Modal","ModalOverlay","ModalContent","ModalHeader","ModalFooter","ModalBody","useDisclosure","VStack","HStack","FormControl","useToast","Head","router","useState","useEffect","getSession","useSession","useForm","yup","yupResolver","FiPaperclip","AiFillHeart","AiOutlineHeart","supabase","Input","NotFound","api","MaterialList","useGetLatestMaterials","useGetTopLikedMaterials","useLocale","incrementCourseView","createMaterialFormSchema","object","shape","name","string","max","required","description","image","url","link","tags","lowercase","min","CoursePage","singleCourseData","currentUser","courseLiked","isOpen","onOpen","onClose","liked","setLiked","session","toast","t","id","currentUserId","courseId","data","latestsMaterialsData","isLoading","isLoadingLatestMaterials","isFetching","isFetchingLatestMaterials","error","errorLatestMaterials","topMaterialsData","isLoadingTopMaterials","isFetchingTopMaterials","errorTopMaterials","register","handleSubmit","formState","errors","resolver","handleCreateMaterial","values","response","post","headers","type","Promise","resolve","setTimeout","title","coursePage","status","duration","isClosable","position","onCloseComplete","push","newMaterialId","handleLikeCourse","page404","tabMessage","course","md","sm","lg","topSummaries","latestSummaries","form","newMaterial","nameEx","bgColor","imageURL","imageURLEx","materialLink","materialLinkEx","tagsEx","isSubmitting","getServerSideProps","params","req","currentUserEmail","user","email","from","select","eq","single","String","materialsArray","props"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable react/no-unescaped-entities */\nimport {\n  Text,\n  Img,\n  Spacer,\n  Button,\n  Icon,\n  Box,\n  Modal,\n  ModalOverlay,\n  ModalContent,\n  ModalHeader,\n  ModalFooter,\n  ModalBody,\n  useDisclosure,\n  VStack,\n  HStack,\n  FormControl,\n  useToast,\n} from '@chakra-ui/react';\nimport { GetServerSideProps } from 'next';\nimport Head from 'next/head';\nimport router from 'next/router';\nimport { useState, useEffect } from 'react';\nimport { getSession, useSession } from 'next-auth/client';\nimport { SubmitHandler, useForm } from 'react-hook-form';\nimport * as yup from 'yup';\nimport { yupResolver } from '@hookform/resolvers/yup';\n\nimport { FiPaperclip } from 'react-icons/fi';\nimport { AiFillHeart, AiOutlineHeart } from 'react-icons/ai';\n\nimport { supabase } from '../../../services/supabase';\nimport { Input } from '../../../components/form/input';\nimport { NotFound } from '../../../components/NotFound';\nimport { api } from '../../../services/api';\nimport { MaterialList } from '../../../components/MaterialList';\nimport {\n  useGetLatestMaterials,\n  useGetTopLikedMaterials,\n} from '../../../services/hooks/useMaterials';\nimport useLocale from '../../../services/hooks/useLocale';\nimport { incrementCourseView } from '../../../services/hooks/useCourses';\n\ntype CreateMaterialData = {\n  course_id: string;\n  name: string;\n  description: string;\n  image?: string;\n  link: string;\n  tags: string;\n  creator_id: string;\n};\n\ntype CurrentUserData = {\n  id: string;\n  name: string;\n  avatar_url: string;\n  id: number;\n};\n\ntype SingleCourseData = {\n  id: string;\n  image: string;\n  name: string;\n  description: string;\n  likes: number;\n  tags: string;\n  id: number;\n};\n\ninterface CoursePageProps {\n  singleCourseData: SingleCourseData;\n  currentUser: CurrentUserData;\n  courseLiked: boolean;\n}\n\nconst createMaterialFormSchema = yup.object().shape({\n  name: yup\n    .string()\n    .max(120, 'Maximum 120 characters')\n    .required('Wait, you would not forget the name would you?'),\n  description: yup\n    .string()\n    .max(200, 'Maximum 200 characters')\n    .required(`Don't forget the description`),\n  image: yup.string().url(),\n  link: yup.string().url().required('Material link required'),\n  tags: yup\n    .string()\n    .lowercase()\n    .min(3, 'Come on, at least 3 characters you can do it')\n    .max(144, 'Maximum 144 characters')\n    .required('Tags are important to help others to find the course :)'),\n});\n\nexport default function CoursePage({\n  singleCourseData,\n  currentUser,\n  courseLiked,\n}: CoursePageProps) {\n  const { isOpen, onOpen, onClose } = useDisclosure();\n  const [liked, setLiked] = useState(courseLiked);\n  const [session] = useSession();\n  const toast = useToast();\n  const t = useLocale();\n\n  useEffect(() => {\n    incrementCourseView(singleCourseData.id);\n  }, []);\n\n  const currentUserId = currentUser?.id;\n  const courseId = singleCourseData?.id;\n\n  const {\n    data: latestsMaterialsData,\n    isLoading: isLoadingLatestMaterials,\n    isFetching: isFetchingLatestMaterials,\n    error: errorLatestMaterials,\n  } = useGetLatestMaterials(courseId);\n\n  const {\n    data: topMaterialsData,\n    isLoading: isLoadingTopMaterials,\n    isFetching: isFetchingTopMaterials,\n    error: errorTopMaterials,\n  } = useGetTopLikedMaterials(courseId);\n\n  const { register, handleSubmit, formState, errors } = useForm({\n    resolver: yupResolver(createMaterialFormSchema),\n  });\n\n  const handleCreateMaterial: SubmitHandler<CreateMaterialData> = async values => {\n    const response = await api.post('/api/supaRequests', {\n      headers: {\n        type: 'course-create-material',\n      },\n      values,\n      currentUserId,\n      courseId,\n    });\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n\n    onClose();\n\n    toast({\n      title: `${t.coursePage.toast.title}`,\n      description: `${t.coursePage.toast.description}`,\n      status: 'success',\n      duration: 2000,\n      isClosable: true,\n      position: 'top-right',\n      onCloseComplete: () =>\n        router.push(`/community/summary/${response.data.newMaterialId}`),\n    });\n  };\n\n  const handleLikeCourse = async () => {\n    if (session) {\n      if (liked === false) {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-like-course',\n          },\n          currentUserId,\n          courseId,\n        });\n      } else {\n        setLiked(!liked);\n        const response = await api.post('/api/supaRequests', {\n          headers: {\n            type: 'course-unlike-course',\n          },\n          currentUserId,\n          courseId,\n        });\n      }\n    }\n  };\n\n  if (singleCourseData === null) {\n    return (\n      <>\n        <Head>\n          <title>{t.page404.tabMessage}</title>\n        </Head>\n\n        <NotFound />\n      </>\n    );\n  }\n\n  const course = singleCourseData;\n\n  return (\n    <>\n      <Head>\n        <title>{course.name}</title>\n      </Head>\n\n      <Box\n        w=\"90%\"\n        mx=\"auto\"\n        display={{ md: 'flex' }}\n        maxWidth={1080}\n        marginTop={12}\n        marginBottom={4}\n        border=\"1px\"\n        borderColor=\"green.700\"\n        borderRadius=\"2xl\"\n        justifyContent=\"center\"\n      >\n        <Box\n          position=\"relative\"\n          maxHeight={{ sm: '240px', md: 'xl', lg: 'xl' }}\n          h={{ lg: 'xl', md: 'xl', sm: '240px' }}\n          w={{ sm: '100%', md: '50%', lg: '50%' }}\n          borderRadius=\"2xl\"\n        >\n          <Img\n            maxHeight={{ lg: 'xl', md: 'xl', sm: '240px' }}\n            h={{ lg: 'xl', md: 'xl', sm: '240px' }}\n            w=\"50%\"\n            boxSize=\"100%\"\n            objectFit=\"cover\"\n            src={\n              course.image !== ''\n                ? course.image\n                : '/assets/illustrations/courseImg.jpg'\n            }\n            fallbac=\"/assets/illustrations/courseImg.jpg\"\n            alt=\"Course Image\"\n            borderRadius=\"2xl\"\n          />\n        </Box>\n\n        <VStack\n          h={{ md: 'xl', sm: 'md' }}\n          w={{ sm: '100%', md: '50%', lg: '50%' }}\n          bg=\"purple.900\"\n          minWidth={{ md: '50%', lg: '50%' }}\n          alignItems=\"left\"\n          borderBottomRadius=\"2xl\"\n          borderTopRightRadius=\"2xl\"\n        >\n          <Text\n            mb={['1', '2', '4']}\n            fontWeight=\"700\"\n            fontSize={['xl', '2xl', '3xl']}\n            lineHeight=\"9\"\n            px={['6', '8']}\n            pt={['2', '3', '6']}\n          >\n            {course.name}\n          </Text>\n\n          <Text\n            px={['6', '8']}\n            lineHeight=\"5\"\n            color=\"green.600\"\n            noOfLines={6}\n            fontSize={['sm', 'md', 'lg']}\n          >\n            {course.description}\n          </Text>\n\n          <Spacer />\n          {/*\n          <Box px=\"8\">\n            <Text fontWeight=\"200\" fontSize={['lg', 'xl']} color=\"gray.300\">\n              <strong>{course.buddys_coursing}</strong> Buddy's estão fazendo\n              esse curso\n            </Text>\n\n            <Button\n              size=\"md\"\n              mt=\"4\"\n              colorScheme=\"purple\"\n              color=\"purple.900\"\n              _focus={{ boxShadow: 'none' }}\n              _hover={{ bg: 'purple.550' }}\n            >\n              Ver Buddy's\n            </Button>\n          </Box> */}\n          <Box align=\"right\" w=\"100%\">\n            <HStack\n              w=\"16\"\n              bgColor=\"green.900\"\n              borderBottomRightRadius=\"2xl\"\n              borderTopLeftRadius=\"2xl\"\n            >\n              <Button\n                pl=\"5\"\n                size=\"lg\"\n                color=\"green.500\"\n                variant=\"unstyled\"\n                fontSize=\"2xl\"\n                justifyContent=\"center\"\n                onClick={handleLikeCourse}\n                isDisabled={!session}\n              >\n                {liked ? <AiFillHeart /> : <AiOutlineHeart />}\n              </Button>\n            </HStack>\n          </Box>\n        </VStack>\n      </Box>\n\n      <Box w=\"90%\" mx=\"auto\" my={12} maxWidth={1080} justifyContent=\"center\">\n        <MaterialList\n          title={t.coursePage.topSummaries}\n          materialArray={topMaterialsData}\n          isLoading={isLoadingTopMaterials}\n          isFetching={isFetchingTopMaterials}\n          error={errorTopMaterials}\n        />\n\n        <MaterialList\n          title={t.coursePage.latestSummaries}\n          materialArray={latestsMaterialsData}\n          isLoading={isLoadingLatestMaterials}\n          isFetching={isFetchingLatestMaterials}\n          error={errorLatestMaterials}\n        />\n      </Box>\n\n      {!!session && (\n        <Button\n          w=\"16\"\n          h=\"16\"\n          colorScheme=\"purple\"\n          position=\"fixed\"\n          bottom=\"36px\"\n          right=\"36px\"\n          alignItems=\"center\"\n          borderRadius=\"full\"\n          size=\"lg\"\n          fontSize=\"lg\"\n          onClick={onOpen}\n        >\n          <Icon as={FiPaperclip} fontSize=\"32\" />\n        </Button>\n      )}\n\n      <Modal\n        isCentered\n        size=\"2xl\"\n        onClose={onClose}\n        isOpen={isOpen}\n        motionPreset=\"slideInBottom\"\n        blockScrollOnMount={false}\n      >\n        <ModalOverlay />\n        <ModalContent bg=\"purple.800\">\n          <ModalHeader>{t.coursePage.form.newMaterial}</ModalHeader>\n          <ModalBody>\n            <FormControl>\n              <Box\n                as=\"form\"\n                flex=\"1\"\n                borderRadius={8}\n                bg=\"purple.800\"\n                px=\"8\"\n                py=\"2\"\n                onSubmit={handleSubmit(handleCreateMaterial)}\n              >\n                <VStack spacing=\"4\">\n                  <Input\n                    name=\"name\"\n                    label={t.coursePage.form.name}\n                    description={t.coursePage.form.nameEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.name}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"description\"\n                    label={t.coursePage.form.description}\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.description}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"image\"\n                    label={t.coursePage.form.imageURL}\n                    description={t.coursePage.form.imageURLEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.image}\n                    ref={register}\n                  />\n\n                  <Input\n                    name=\"link\"\n                    label={t.coursePage.form.materialLink}\n                    description={t.coursePage.form.materialLinkEx}\n                    descriptionColor=\"purple.300\"\n                    focusBorderColor=\"purple.600\"\n                    bg=\"purple.600\"\n                    variant=\"filled\"\n                    _hover={{\n                      bgColor: 'purple.700',\n                    }}\n                    error={errors.link}\n                    ref={register}\n                  />\n\n                  <Box w=\"100%\" justify=\"flex-initial\">\n                    <Input\n                      name=\"tags\"\n                      label={t.coursePage.form.tags}\n                      description={t.coursePage.form.tagsEx}\n                      descriptionColor=\"purple.300\"\n                      focusBorderColor=\"purple.600\"\n                      bg=\"purple.600\"\n                      variant=\"filled\"\n                      _hover={{\n                        bgColor: 'purple.700',\n                      }}\n                      error={errors.tags}\n                      ref={register}\n                    />\n                  </Box>\n                </VStack>\n              </Box>\n            </FormControl>\n          </ModalBody>\n          <ModalFooter>\n            <Button\n              as=\"a\"\n              colorScheme=\"whiteAlpha\"\n              variant=\"ghost\"\n              onClick={onClose}\n            >\n              Close\n            </Button>\n            <Button\n              type=\"submit\"\n              colorScheme=\"purple\"\n              _hover={{\n                bgColor: 'purple.600',\n              }}\n              ml=\"4\"\n              isLoading={formState.isSubmitting}\n              onClick={handleSubmit(handleCreateMaterial)}\n            >\n              Create\n            </Button>\n          </ModalFooter>\n        </ModalContent>\n      </Modal>\n    </>\n  );\n}\n\nexport const getServerSideProps: GetServerSideProps = async ({\n  params,\n  req,\n}) => {\n  const { id: id } = params;\n  const session = await getSession({ req });\n\n  const currentUserEmail = session?.user.email;\n\n  const { data: currentUser } = await supabase\n    .from('users')\n    .select('id, name, email, avatar_url, id')\n    .eq('email', `${currentUserEmail}`)\n    .single();\n\n  const { data: singleCourseData } = await supabase\n    .from('courses')\n    .select(\n      'id, id, name, image, likes, id, description, tags'\n    )\n    .eq('id', String(id))\n    .single();\n\n  const { data: materialsArray } = await supabase\n    .from('materials')\n    .select(\n      `\n    *,\n    users: user_id ( name )\n  `\n    )\n    .eq('course_id', String(singleCourseData?.id));\n\n  const { data: liked } = await supabase\n    .from('course_likes')\n    .select(\n      `\n        *,\n        users: user_id ( name )\n        `\n    )\n    .eq('course_id', String(singleCourseData?.id))\n    .eq('user_id', String(currentUser?.id))\n    .single();\n\n  const courseLiked = liked !== null;\n  return {\n    props: {\n      singleCourseData,\n      materialsArray,\n      currentUser,\n      courseLiked,\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}